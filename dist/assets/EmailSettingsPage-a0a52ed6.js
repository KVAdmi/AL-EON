import{a as h,r as l,j as e,e as N,u as A}from"./index-e4e1323c.js";import{d as C,g as E}from"./emailService-c4da49df.js";import{E as k}from"./EmailAccountForm-543e3b3c.js";import{M as f}from"./mail-1aad0795.js";import{P as S}from"./pen-line-7665e45d.js";import{T as w}from"./trash-2-720af3a0.js";import{A as P}from"./arrow-left-1a8dd8e5.js";import"./requestId-b38e007e.js";import"./upload-d0cbcdb1.js";import"./eye-off-ed9c0be4.js";import"./eye-3ec80a3c.js";import"./check-circle-2-1ec1591c.js";import"./x-circle-14dea691.js";import"./loader-2-b4ab27ec.js";function M({accounts:c,onEdit:x,onAccountUpdated:u}){const{toast:d}=h();l.useState(null);async function n(r){if(confirm("¿Eliminar esta cuenta de email?"))try{await C(r),d({title:"Cuenta eliminada",description:"La cuenta se eliminó correctamente"}),u()}catch(o){d({variant:"destructive",title:"Error",description:o.message||"No se pudo eliminar la cuenta"})}}return e.jsx("div",{className:"space-y-3",children:c.map(r=>{var o,i,s,a,m;return e.jsxs("div",{className:"p-5 rounded-xl border flex items-center justify-between group hover:shadow-sm transition-all",style:{backgroundColor:"var(--color-bg-secondary)",borderColor:"var(--color-border)"},children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center",style:{backgroundColor:"var(--color-bg-primary)"},children:e.jsx(f,{size:24,style:{color:"var(--color-accent)"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold",style:{color:"var(--color-text-primary)"},children:r.fromName}),r.is_active?e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full font-medium",style:{backgroundColor:"rgba(16, 185, 129, 0.1)",color:"var(--color-success, #10b981)"},children:"Activa"}):e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full font-medium",style:{backgroundColor:"rgba(107, 114, 128, 0.1)",color:"var(--color-text-tertiary)"},children:"Inactiva"})]}),e.jsx("p",{className:"text-sm mb-2",style:{color:"var(--color-text-secondary)"},children:r.fromEmail}),e.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1.5",style:{color:"var(--color-text-tertiary)"},children:[e.jsx("span",{className:"font-medium",children:"SMTP:"}),e.jsxs("span",{children:[(o=r.smtp)==null?void 0:o.host,":",(i=r.smtp)==null?void 0:i.port]})]}),((s=r.imap)==null?void 0:s.enabled)&&e.jsxs("div",{className:"flex items-center gap-1.5",style:{color:"var(--color-text-tertiary)"},children:[e.jsx("span",{className:"font-medium",children:"IMAP:"}),e.jsxs("span",{children:[(a=r.imap)==null?void 0:a.host,":",(m=r.imap)==null?void 0:m.port]})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>x(r),className:"p-2 rounded-lg transition-all hover:opacity-80",style:{backgroundColor:"var(--color-bg-primary)",color:"var(--color-text-secondary)"},title:"Editar",children:e.jsx(S,{size:16})}),e.jsx("button",{onClick:()=>n(r.id),className:"p-2 rounded-lg transition-all hover:opacity-80",style:{backgroundColor:"var(--color-bg-primary)",color:"var(--color-error, #ef4444)"},title:"Eliminar",children:e.jsx(w,{size:16})})]})]},r.id)})})}function J(){const{user:c,accessToken:x}=N(),{toast:u}=h(),d=A(),[n,r]=l.useState([]),[o,i]=l.useState(!0),[s,a]=l.useState(!1),[m,p]=l.useState(null);l.useEffect(()=>{v()},[c]);async function v(){if(c)try{i(!0);const t=await E(c.id,x);r(t||[])}catch(t){console.error("Error cargando cuentas:",t),u({variant:"destructive",title:"Error",description:t.message||"No se pudieron cargar las cuentas de email"})}finally{i(!1)}}function g(){p(null),a(!0)}function b(t){p(t),a(!0)}function y(){a(!1),p(null)}function j(){v(),y()}return e.jsx("div",{className:"h-screen overflow-y-auto",style:{backgroundColor:"var(--color-bg-primary)"},children:e.jsxs("div",{className:"max-w-5xl mx-auto p-6 pb-32",children:[e.jsxs("button",{onClick:()=>d(-1),className:"flex items-center gap-2 mb-6 px-4 py-2 rounded-lg transition-all hover:opacity-80",style:{backgroundColor:"var(--color-bg-secondary)",color:"var(--color-text-primary)",border:"1px solid var(--color-border)"},children:[e.jsx(P,{size:18}),e.jsx("span",{className:"font-medium",children:"Volver"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",style:{color:"var(--color-text-primary)"},children:"Configuración de Correo"}),e.jsx("p",{style:{color:"var(--color-text-secondary)"},children:"Gestiona tus cuentas SMTP/IMAP para envío y recepción de emails"})]}),o?e.jsx("div",{className:"text-center py-12",style:{color:"var(--color-text-secondary)"},children:"Cargando cuentas..."}):e.jsxs(e.Fragment,{children:[n.length>0&&!s&&e.jsx("div",{className:"mb-6",children:e.jsx(M,{accounts:n,onEdit:b,onAccountUpdated:v})}),s?e.jsx("div",{className:"p-6 rounded-xl border",style:{backgroundColor:"var(--color-bg-secondary)",borderColor:"var(--color-border)"},children:e.jsx(k,{account:m,onSave:j,onCancel:y})}):e.jsx("button",{onClick:g,className:"w-full py-4 px-6 rounded-xl border-2 border-dashed transition-all hover:border-solid",style:{borderColor:"var(--color-border)",color:"var(--color-text-secondary)"},children:e.jsx("span",{className:"font-medium",children:"+ Agregar cuenta de correo"})}),n.length===0&&!s&&e.jsxs("div",{className:"text-center py-12 rounded-xl border",style:{backgroundColor:"var(--color-bg-secondary)",borderColor:"var(--color-border)"},children:[e.jsx(f,{size:64,style:{color:"var(--color-text-tertiary)",opacity:.3,marginBottom:"16px"}}),e.jsx("h3",{className:"text-xl font-semibold mb-2",style:{color:"var(--color-text-primary)"},children:"No hay cuentas configuradas"}),e.jsx("p",{className:"mb-6",style:{color:"var(--color-text-secondary)"},children:"Agrega tu primera cuenta SMTP/IMAP para comenzar"})]})]})]})})}export{J as default};
